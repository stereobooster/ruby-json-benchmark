Ignoring: branches, cache, langauge, sudo
START gemfile: gemfiles/4.1.16.gemfile rvm: 2.2.6
bundle install --deployment --path ruby-json-benchmark/vendor/bundle --quiet
bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark2.rb

Comparing Rails to_json with other JSON implementations
+---------------------------------+---------------+----------------+----------------+-------------------------+
| class                           | JSON.generate | Oj.dump object | Oj.dump compat | Oj.dump compat, as_json |
+---------------------------------+---------------+----------------+----------------+-------------------------+
| Regexp                          | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| FalseClass                      | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| NilClass                        | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Object                          | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| TrueClass                       | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| String                          | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringChinese                   | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringSpecial                   | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringSpecial2                  | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringSpecial3                  | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Numeric                         | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Symbol                          | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Time                            | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Array                           | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Hash                            | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| HashNotEmpty                    | ğŸ‘Œ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Date                            | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| DateTime                        | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Enumerable                      | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| BigDecimal                      | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| BigDecimalInfinity              | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Struct                          | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Float                           | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| FloatInfinity                   | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Range                           | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| Complex                         | ğŸ’€            | ğŸ’€             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Exception                       | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| OpenStruct                      | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Rational                        | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Process::Status                 | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveSupport::TimeWithZone     | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveModel::Errors             | ğŸ’€            | ğŸ’€             | ğŸ’€             | ğŸ‘Œ                      |
| ActiveSupport::Duration         | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| ActiveSupport::Multibyte::Chars | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveRecord::Relation          | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveRecord                    | ğŸ’€            | ğŸ’€             | ğŸ’€             | ğŸ‘Œ                      |
+---------------------------------+---------------+----------------+----------------+-------------------------+

Calculating -------------------------------------
            to_json:   524.323M memsize (   248.000  retained)
                        10.600M objects (     4.000  retained)
                        50.000  strings (     0.000  retained)
           Oj.dump o   164.310M memsize (     0.000  retained)
                         3.340M objects (     0.000  retained)
                        46.000  strings (     0.000  retained)
           Oj.dump c   164.310M memsize (     0.000  retained)
                         3.340M objects (     0.000  retained)
                        46.000  strings (     0.000  retained)
       Oj.dump c, aj   164.310M memsize (     0.000  retained)
                         3.340M objects (     0.000  retained)
                        46.000  strings (     0.000  retained)

Comparison:
       Oj.dump c, aj:  164310000 allocated
           Oj.dump o:  164310000 allocated - same
           Oj.dump c:  164310000 allocated - same
            to_json::  524322520 allocated - 3.19x more
---------------------------------------------

                     user     system      total        real
to_json:         3.480000   0.110000   3.590000 (  3.619035)
Oj.dump o      benchmark2.rb:32:in `dump': Too deeply nested. (NoMemoryError)
	from benchmark2.rb:32:in `block (3 levels) in <main>'
	from benchmark2.rb:32:in `times'
	from benchmark2.rb:32:in `block (2 levels) in <main>'
	from .rbenv/versions/2.2.6/lib/ruby/2.2.0/benchmark.rb:288:in `measure'
	from .rbenv/versions/2.2.6/lib/ruby/2.2.0/benchmark.rb:370:in `item'
	from benchmark2.rb:32:in `block in <main>'
	from .rbenv/versions/2.2.6/lib/ruby/2.2.0/benchmark.rb:172:in `benchmark'
	from benchmark2.rb:29:in `<main>'
FAILURE gemfile: gemfiles/4.1.16.gemfile rvm: 2.2.6
START gemfile: gemfiles/4.1.16.gemfile rvm: 2.3.3
bundle install --deployment --path ruby-json-benchmark/vendor/bundle --quiet
bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark2.rb

Comparing Rails to_json with other JSON implementations
+---------------------------------+---------------+----------------+----------------+-------------------------+
| class                           | JSON.generate | Oj.dump object | Oj.dump compat | Oj.dump compat, as_json |
+---------------------------------+---------------+----------------+----------------+-------------------------+
| Regexp                          | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| FalseClass                      | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| NilClass                        | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Object                          | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| TrueClass                       | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| String                          | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringChinese                   | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringSpecial                   | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringSpecial2                  | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringSpecial3                  | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Numeric                         | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Symbol                          | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Time                            | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Array                           | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Hash                            | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| HashNotEmpty                    | ğŸ‘Œ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Date                            | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| DateTime                        | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Enumerable                      | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| BigDecimal                      | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| BigDecimalInfinity              | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Struct                          | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Float                           | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| FloatInfinity                   | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Range                           | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| Complex                         | ğŸ’€            | ğŸ’€             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Exception                       | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| OpenStruct                      | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Rational                        | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Process::Status                 | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveSupport::TimeWithZone     | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveModel::Errors             | ğŸ’€            | ğŸ’€             | ğŸ’€             | ğŸ‘Œ                      |
| ActiveSupport::Duration         | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| ActiveSupport::Multibyte::Chars | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveRecord::Relation          | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveRecord                    | ğŸ’€            | ğŸ’€             | ğŸ’€             | ğŸ‘Œ                      |
+---------------------------------+---------------+----------------+----------------+-------------------------+

Calculating -------------------------------------
            to_json:   521.123M memsize (   248.000  retained)
                        10.520M objects (     4.000  retained)
                        50.000  strings (     0.000  retained)
           Oj.dump o   158.710M memsize (     0.000  retained)
                         3.200M objects (     0.000  retained)
                        46.000  strings (     0.000  retained)
           Oj.dump c   158.710M memsize (     0.000  retained)
                         3.200M objects (     0.000  retained)
                        46.000  strings (     0.000  retained)
       Oj.dump c, aj   158.710M memsize (     0.000  retained)
                         3.200M objects (     0.000  retained)
                        46.000  strings (     0.000  retained)

Comparison:
           Oj.dump o:  158710000 allocated
           Oj.dump c:  158710000 allocated - same
       Oj.dump c, aj:  158710000 allocated - same
            to_json::  521122520 allocated - 3.28x more
---------------------------------------------

                     user     system      total        real
to_json:         3.700000   0.090000   3.790000 (  3.814738)
Oj.dump o      benchmark2.rb:32:in `dump': Too deeply nested. (NoMemoryError)
	from benchmark2.rb:32:in `block (3 levels) in <main>'
	from benchmark2.rb:32:in `times'
	from benchmark2.rb:32:in `block (2 levels) in <main>'
	from .rbenv/versions/2.3.3/lib/ruby/2.3.0/benchmark.rb:293:in `measure'
	from .rbenv/versions/2.3.3/lib/ruby/2.3.0/benchmark.rb:375:in `item'
	from benchmark2.rb:32:in `block in <main>'
	from .rbenv/versions/2.3.3/lib/ruby/2.3.0/benchmark.rb:173:in `benchmark'
	from benchmark2.rb:29:in `<main>'
FAILURE gemfile: gemfiles/4.1.16.gemfile rvm: 2.3.3
START gemfile: gemfiles/4.1.16.gemfile rvm: 2.4.0
bundle install --deployment --path ruby-json-benchmark/vendor/bundle --quiet
bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark2.rb
ruby-json-benchmark/vendor/bundle/ruby/2.4.0/gems/activesupport-4.1.16/lib/active_support/core_ext/numeric/time.rb:50:in `*': ActiveSupport::Duration can't be coerced into Integer (TypeError)
	from ruby-json-benchmark/vendor/bundle/ruby/2.4.0/gems/activesupport-4.1.16/lib/active_support/core_ext/numeric/time.rb:50:in `days'
	from ruby-json-benchmark/vendor/bundle/ruby/2.4.0/gems/activesupport-4.1.16/lib/active_support/core_ext/integer/time.rb:36:in `months'
	from ruby-json-benchmark/test_data.rb:92:in `<top (required)>'
	from compatibility_test.rb:1:in `require'
	from compatibility_test.rb:1:in `<main>'
FAILURE gemfile: gemfiles/4.1.16.gemfile rvm: 2.4.0
START gemfile: gemfiles/4.2.8.gemfile  rvm: 2.2.6
bundle install --deployment --path ruby-json-benchmark/vendor/bundle --quiet
bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark2.rb

Comparing Rails to_json with other JSON implementations
+---------------------------------+---------------+----------------+----------------+-------------------------+
| class                           | JSON.generate | Oj.dump object | Oj.dump compat | Oj.dump compat, as_json |
+---------------------------------+---------------+----------------+----------------+-------------------------+
| Regexp                          | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| FalseClass                      | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| NilClass                        | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Object                          | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| TrueClass                       | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| String                          | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringChinese                   | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringSpecial                   | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringSpecial2                  | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringSpecial3                  | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Numeric                         | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Symbol                          | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Time                            | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Array                           | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Hash                            | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| HashNotEmpty                    | ğŸ‘Œ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Date                            | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| DateTime                        | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Enumerable                      | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| BigDecimal                      | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| BigDecimalInfinity              | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Struct                          | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Float                           | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| FloatInfinity                   | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Range                           | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| Complex                         | ğŸ’€            | ğŸ’€             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Exception                       | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| OpenStruct                      | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Rational                        | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Process::Status                 | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveSupport::TimeWithZone     | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveModel::Errors             | ğŸ’€            | ğŸ’€             | ğŸ’€             | ğŸ‘Œ                      |
| ActiveSupport::Duration         | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| ActiveSupport::Multibyte::Chars | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveRecord::Relation          | ğŸ’€            | âŒ             | ğŸ’€             | ğŸ‘Œ                      |
| ActiveRecord                    | ğŸ’€            | ğŸ’€             | ğŸ’€             | ğŸ‘Œ                      |
+---------------------------------+---------------+----------------+----------------+-------------------------+

Calculating -------------------------------------
            to_json:   529.043M memsize (   576.000  retained)
                        10.670M objects (     7.000  retained)
                        50.000  strings (     0.000  retained)
           Oj.dump o   168.230M memsize (     0.000  retained)
                         3.390M objects (     0.000  retained)
                        46.000  strings (     0.000  retained)
           Oj.dump c   168.230M memsize (     0.000  retained)
                         3.390M objects (     0.000  retained)
                        46.000  strings (     0.000  retained)
       Oj.dump c, aj   168.230M memsize (     0.000  retained)
                         3.390M objects (     0.000  retained)
                        46.000  strings (     0.000  retained)

Comparison:
       Oj.dump c, aj:  168230000 allocated
           Oj.dump o:  168230000 allocated - same
           Oj.dump c:  168230000 allocated - same
            to_json::  529042752 allocated - 3.14x more
---------------------------------------------

                     user     system      total        real
to_json:         3.810000   0.090000   3.900000 (  3.938340)
Oj.dump o      benchmark2.rb:32:in `dump': Too deeply nested. (NoMemoryError)
	from benchmark2.rb:32:in `block (3 levels) in <main>'
	from benchmark2.rb:32:in `times'
	from benchmark2.rb:32:in `block (2 levels) in <main>'
	from .rbenv/versions/2.2.6/lib/ruby/2.2.0/benchmark.rb:288:in `measure'
	from .rbenv/versions/2.2.6/lib/ruby/2.2.0/benchmark.rb:370:in `item'
	from benchmark2.rb:32:in `block in <main>'
	from .rbenv/versions/2.2.6/lib/ruby/2.2.0/benchmark.rb:172:in `benchmark'
	from benchmark2.rb:29:in `<main>'
FAILURE gemfile: gemfiles/4.2.8.gemfile  rvm: 2.2.6
START gemfile: gemfiles/4.2.8.gemfile  rvm: 2.3.3
bundle install --deployment --path ruby-json-benchmark/vendor/bundle --quiet
bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark2.rb

Comparing Rails to_json with other JSON implementations
+---------------------------------+---------------+----------------+----------------+-------------------------+
| class                           | JSON.generate | Oj.dump object | Oj.dump compat | Oj.dump compat, as_json |
+---------------------------------+---------------+----------------+----------------+-------------------------+
| Regexp                          | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| FalseClass                      | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| NilClass                        | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Object                          | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| TrueClass                       | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| String                          | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringChinese                   | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringSpecial                   | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringSpecial2                  | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringSpecial3                  | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Numeric                         | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Symbol                          | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Time                            | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Array                           | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Hash                            | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| HashNotEmpty                    | ğŸ‘Œ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Date                            | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| DateTime                        | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Enumerable                      | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| BigDecimal                      | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| BigDecimalInfinity              | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Struct                          | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Float                           | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| FloatInfinity                   | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Range                           | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| Complex                         | ğŸ’€            | ğŸ’€             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Exception                       | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| OpenStruct                      | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Rational                        | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Process::Status                 | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveSupport::TimeWithZone     | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveModel::Errors             | ğŸ’€            | ğŸ’€             | ğŸ’€             | ğŸ‘Œ                      |
| ActiveSupport::Duration         | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| ActiveSupport::Multibyte::Chars | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveRecord::Relation          | ğŸ’€            | âŒ             | ğŸ’€             | ğŸ‘Œ                      |
| ActiveRecord                    | ğŸ’€            | ğŸ’€             | ğŸ’€             | ğŸ‘Œ                      |
+---------------------------------+---------------+----------------+----------------+-------------------------+

Calculating -------------------------------------
            to_json:   525.843M memsize (   344.000  retained)
                        10.590M objects (     5.000  retained)
                        50.000  strings (     0.000  retained)
           Oj.dump o   162.630M memsize (     0.000  retained)
                         3.250M objects (     0.000  retained)
                        46.000  strings (     0.000  retained)
           Oj.dump c   162.630M memsize (     0.000  retained)
                         3.250M objects (     0.000  retained)
                        46.000  strings (     0.000  retained)
       Oj.dump c, aj   162.630M memsize (     0.000  retained)
                         3.250M objects (     0.000  retained)
                        46.000  strings (     0.000  retained)

Comparison:
           Oj.dump o:  162630000 allocated
           Oj.dump c:  162630000 allocated - same
       Oj.dump c, aj:  162630000 allocated - same
            to_json::  525842520 allocated - 3.23x more
---------------------------------------------

                     user     system      total        real
to_json:         3.860000   0.070000   3.930000 (  3.981245)
Oj.dump o      benchmark2.rb:32:in `dump': Too deeply nested. (NoMemoryError)
	from benchmark2.rb:32:in `block (3 levels) in <main>'
	from benchmark2.rb:32:in `times'
	from benchmark2.rb:32:in `block (2 levels) in <main>'
	from .rbenv/versions/2.3.3/lib/ruby/2.3.0/benchmark.rb:293:in `measure'
	from .rbenv/versions/2.3.3/lib/ruby/2.3.0/benchmark.rb:375:in `item'
	from benchmark2.rb:32:in `block in <main>'
	from .rbenv/versions/2.3.3/lib/ruby/2.3.0/benchmark.rb:173:in `benchmark'
	from benchmark2.rb:29:in `<main>'
FAILURE gemfile: gemfiles/4.2.8.gemfile  rvm: 2.3.3
START gemfile: gemfiles/4.2.8.gemfile  rvm: 2.4.0
bundle install --deployment --path ruby-json-benchmark/vendor/bundle --quiet
bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark2.rb

Comparing Rails to_json with other JSON implementations
+---------------------------------+---------------+----------------+----------------+-------------------------+
| class                           | JSON.generate | Oj.dump object | Oj.dump compat | Oj.dump compat, as_json |
+---------------------------------+---------------+----------------+----------------+-------------------------+
| Regexp                          | ğŸ‘Œ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| FalseClass                      | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| NilClass                        | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Object                          | âŒ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| TrueClass                       | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| String                          | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringChinese                   | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringSpecial                   | âŒ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringSpecial2                  | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringSpecial3                  | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Numeric                         | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Symbol                          | ğŸ‘Œ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Time                            | âŒ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Array                           | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Hash                            | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| HashNotEmpty                    | ğŸ‘Œ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Date                            | ğŸ‘Œ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| DateTime                        | âŒ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Enumerable                      | âŒ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| BigDecimal                      | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| BigDecimalInfinity              | âŒ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Struct                          | âŒ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Float                           | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| FloatInfinity                   | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Range                           | ğŸ‘Œ            | âŒ             | âŒ             | ğŸ‘Œ                      |
| Complex                         | ğŸ‘Œ            | ğŸ’€             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Exception                       | âŒ            | âŒ             | âŒ             | ğŸ‘Œ                      |
| OpenStruct                      | âŒ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Rational                        | ğŸ‘Œ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Process::Status                 | âŒ            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveSupport::TimeWithZone     | âŒ            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveModel::Errors             | âŒ            | ğŸ’€             | ğŸ’€             | ğŸ‘Œ                      |
| ActiveSupport::Duration         | âŒ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| ActiveSupport::Multibyte::Chars | ğŸ‘Œ            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveRecord::Relation          | âŒ            | âŒ             | ğŸ’€             | ğŸ‘Œ                      |
| ActiveRecord                    | âŒ            | ğŸ’€             | ğŸ’€             | ğŸ‘Œ                      |
+---------------------------------+---------------+----------------+----------------+-------------------------+

Calculating -------------------------------------
            to_json:   513.632M memsize (   536.000  retained)
                        10.480M objects (     6.000  retained)
                        50.000  strings (     0.000  retained)
           Oj.dump o   154.430M memsize (     0.000  retained)
                         3.140M objects (     0.000  retained)
                        42.000  strings (     0.000  retained)
           Oj.dump c   154.430M memsize (     0.000  retained)
                         3.140M objects (     0.000  retained)
                        42.000  strings (     0.000  retained)
       Oj.dump c, aj   154.430M memsize (     0.000  retained)
                         3.140M objects (     0.000  retained)
                        42.000  strings (     0.000  retained)

Comparison:
           Oj.dump o:  154430000 allocated
           Oj.dump c:  154430000 allocated - same
       Oj.dump c, aj:  154430000 allocated - same
            to_json::  513632272 allocated - 3.33x more
---------------------------------------------

                     user     system      total        real
to_json:         4.210000   0.060000   4.270000 (  4.478330)
Oj.dump o      benchmark2.rb:32:in `dump': Too deeply nested. (NoMemoryError)
	from benchmark2.rb:32:in `block (3 levels) in <main>'
	from benchmark2.rb:32:in `times'
	from benchmark2.rb:32:in `block (2 levels) in <main>'
	from .rbenv/versions/2.4.0/lib/ruby/2.4.0/benchmark.rb:293:in `measure'
	from .rbenv/versions/2.4.0/lib/ruby/2.4.0/benchmark.rb:375:in `item'
	from benchmark2.rb:32:in `block in <main>'
	from .rbenv/versions/2.4.0/lib/ruby/2.4.0/benchmark.rb:173:in `benchmark'
	from benchmark2.rb:29:in `<main>'
FAILURE gemfile: gemfiles/4.2.8.gemfile  rvm: 2.4.0
START gemfile: gemfiles/5.0.2.gemfile  rvm: 2.2.6
bundle install --deployment --path ruby-json-benchmark/vendor/bundle --quiet
bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark2.rb

Comparing Rails to_json with other JSON implementations
+---------------------------------+---------------+----------------+----------------+-------------------------+
| class                           | JSON.generate | Oj.dump object | Oj.dump compat | Oj.dump compat, as_json |
+---------------------------------+---------------+----------------+----------------+-------------------------+
| Regexp                          | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| FalseClass                      | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| NilClass                        | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Object                          | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| TrueClass                       | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| String                          | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringChinese                   | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringSpecial                   | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringSpecial2                  | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringSpecial3                  | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Numeric                         | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Symbol                          | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Time                            | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Array                           | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Hash                            | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| HashNotEmpty                    | ğŸ‘Œ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Date                            | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| DateTime                        | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Enumerable                      | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| BigDecimal                      | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| BigDecimalInfinity              | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Struct                          | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Float                           | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| FloatInfinity                   | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Range                           | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| Complex                         | ğŸ’€            | ğŸ’€             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Exception                       | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| OpenStruct                      | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Rational                        | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Process::Status                 | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveSupport::TimeWithZone     | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveModel::Errors             | ğŸ’€            | ğŸ’€             | ğŸ’€             | ğŸ‘Œ                      |
| ActiveSupport::Duration         | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| ActiveSupport::Multibyte::Chars | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveRecord::Relation          | ğŸ’€            | ğŸ’€             | ğŸ’€             | ğŸ‘Œ                      |
| ActiveRecord                    | ğŸ’€            | ğŸ’€             | ğŸ’€             | ğŸ‘Œ                      |
+---------------------------------+---------------+----------------+----------------+-------------------------+

Calculating -------------------------------------
            to_json:   522.333M memsize (   736.000  retained)
                        10.500M objects (    10.000  retained)
                        50.000  strings (     2.000  retained)
           Oj.dump o   160.320M memsize (   232.000  retained)
                         3.190M objects (     2.000  retained)
                        42.000  strings (     0.000  retained)
           Oj.dump c   160.320M memsize (   232.000  retained)
                         3.190M objects (     2.000  retained)
                        42.000  strings (     0.000  retained)
       Oj.dump c, aj   160.320M memsize (   232.000  retained)
                         3.190M objects (     2.000  retained)
                        42.000  strings (     0.000  retained)

Comparison:
       Oj.dump c, aj:  160320232 allocated
           Oj.dump o:  160320232 allocated - same
           Oj.dump c:  160320232 allocated - same
            to_json::  522333120 allocated - 3.26x more
---------------------------------------------

                     user     system      total        real
to_json:         4.070000   0.160000   4.230000 (  4.411630)
Oj.dump o      benchmark2.rb:32:in `dump': Too deeply nested. (NoMemoryError)
	from benchmark2.rb:32:in `block (3 levels) in <main>'
	from benchmark2.rb:32:in `times'
	from benchmark2.rb:32:in `block (2 levels) in <main>'
	from .rbenv/versions/2.2.6/lib/ruby/2.2.0/benchmark.rb:288:in `measure'
	from .rbenv/versions/2.2.6/lib/ruby/2.2.0/benchmark.rb:370:in `item'
	from benchmark2.rb:32:in `block in <main>'
	from .rbenv/versions/2.2.6/lib/ruby/2.2.0/benchmark.rb:172:in `benchmark'
	from benchmark2.rb:29:in `<main>'
FAILURE gemfile: gemfiles/5.0.2.gemfile  rvm: 2.2.6
START gemfile: gemfiles/5.0.2.gemfile  rvm: 2.3.3
bundle install --deployment --path ruby-json-benchmark/vendor/bundle --quiet
bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark2.rb

Comparing Rails to_json with other JSON implementations
+---------------------------------+---------------+----------------+----------------+-------------------------+
| class                           | JSON.generate | Oj.dump object | Oj.dump compat | Oj.dump compat, as_json |
+---------------------------------+---------------+----------------+----------------+-------------------------+
| Regexp                          | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| FalseClass                      | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| NilClass                        | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Object                          | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| TrueClass                       | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| String                          | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringChinese                   | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringSpecial                   | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringSpecial2                  | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringSpecial3                  | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Numeric                         | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Symbol                          | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Time                            | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Array                           | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Hash                            | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| HashNotEmpty                    | ğŸ‘Œ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Date                            | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| DateTime                        | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Enumerable                      | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| BigDecimal                      | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| BigDecimalInfinity              | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Struct                          | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Float                           | ğŸ’€            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| FloatInfinity                   | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Range                           | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| Complex                         | ğŸ’€            | ğŸ’€             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Exception                       | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| OpenStruct                      | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Rational                        | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Process::Status                 | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveSupport::TimeWithZone     | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveModel::Errors             | ğŸ’€            | ğŸ’€             | ğŸ’€             | ğŸ‘Œ                      |
| ActiveSupport::Duration         | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| ActiveSupport::Multibyte::Chars | ğŸ’€            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveRecord::Relation          | ğŸ’€            | ğŸ’€             | ğŸ’€             | ğŸ‘Œ                      |
| ActiveRecord                    | ğŸ’€            | ğŸ’€             | ğŸ’€             | ğŸ‘Œ                      |
+---------------------------------+---------------+----------------+----------------+-------------------------+

Calculating -------------------------------------
            to_json:   519.133M memsize (   504.000  retained)
                        10.420M objects (     8.000  retained)
                        50.000  strings (     2.000  retained)
           Oj.dump o   154.720M memsize (     0.000  retained)
                         3.050M objects (     0.000  retained)
                        42.000  strings (     0.000  retained)
           Oj.dump c   154.720M memsize (     0.000  retained)
                         3.050M objects (     0.000  retained)
                        42.000  strings (     0.000  retained)
       Oj.dump c, aj   154.720M memsize (     0.000  retained)
                         3.050M objects (     0.000  retained)
                        42.000  strings (     0.000  retained)

Comparison:
           Oj.dump o:  154720000 allocated
           Oj.dump c:  154720000 allocated - same
       Oj.dump c, aj:  154720000 allocated - same
            to_json::  519132888 allocated - 3.36x more
---------------------------------------------

                     user     system      total        real
to_json:         4.210000   0.130000   4.340000 (  4.432474)
Oj.dump o      benchmark2.rb:32:in `dump': Too deeply nested. (NoMemoryError)
	from benchmark2.rb:32:in `block (3 levels) in <main>'
	from benchmark2.rb:32:in `times'
	from benchmark2.rb:32:in `block (2 levels) in <main>'
	from .rbenv/versions/2.3.3/lib/ruby/2.3.0/benchmark.rb:293:in `measure'
	from .rbenv/versions/2.3.3/lib/ruby/2.3.0/benchmark.rb:375:in `item'
	from benchmark2.rb:32:in `block in <main>'
	from .rbenv/versions/2.3.3/lib/ruby/2.3.0/benchmark.rb:173:in `benchmark'
	from benchmark2.rb:29:in `<main>'
FAILURE gemfile: gemfiles/5.0.2.gemfile  rvm: 2.3.3
START gemfile: gemfiles/5.0.2.gemfile  rvm: 2.4.0
bundle install --deployment --path ruby-json-benchmark/vendor/bundle --quiet
bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark2.rb

Comparing Rails to_json with other JSON implementations
+---------------------------------+---------------+----------------+----------------+-------------------------+
| class                           | JSON.generate | Oj.dump object | Oj.dump compat | Oj.dump compat, as_json |
+---------------------------------+---------------+----------------+----------------+-------------------------+
| Regexp                          | ğŸ‘Œ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| FalseClass                      | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| NilClass                        | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Object                          | âŒ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| TrueClass                       | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| String                          | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringChinese                   | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringSpecial                   | âŒ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringSpecial2                  | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| StringSpecial3                  | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Numeric                         | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Symbol                          | ğŸ‘Œ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Time                            | âŒ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Array                           | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Hash                            | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| HashNotEmpty                    | ğŸ‘Œ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Date                            | ğŸ‘Œ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| DateTime                        | âŒ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Enumerable                      | âŒ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| BigDecimal                      | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| BigDecimalInfinity              | âŒ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Struct                          | âŒ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Float                           | ğŸ‘Œ            | ğŸ‘Œ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| FloatInfinity                   | ğŸ’€            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Range                           | ğŸ‘Œ            | âŒ             | âŒ             | ğŸ‘Œ                      |
| Complex                         | ğŸ‘Œ            | ğŸ’€             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Exception                       | ğŸ‘Œ            | âŒ             | âŒ             | ğŸ‘Œ                      |
| OpenStruct                      | âŒ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Rational                        | ğŸ‘Œ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| Process::Status                 | âŒ            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveSupport::TimeWithZone     | âŒ            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveModel::Errors             | âŒ            | ğŸ’€             | ğŸ’€             | ğŸ‘Œ                      |
| ActiveSupport::Duration         | âŒ            | âŒ             | ğŸ‘Œ             | ğŸ‘Œ                      |
| ActiveSupport::Multibyte::Chars | ğŸ‘Œ            | âŒ             | âŒ             | ğŸ‘Œ                      |
| ActiveRecord::Relation          | âŒ            | ğŸ’€             | ğŸ’€             | ğŸ‘Œ                      |
| ActiveRecord                    | âŒ            | ğŸ’€             | ğŸ’€             | ğŸ‘Œ                      |
+---------------------------------+---------------+----------------+----------------+-------------------------+

Calculating -------------------------------------
            to_json:   507.723M memsize (   696.000  retained)
                        10.330M objects (     9.000  retained)
                        50.000  strings (     2.000  retained)
           Oj.dump o   147.320M memsize (     0.000  retained)
                         2.960M objects (     0.000  retained)
                        37.000  strings (     0.000  retained)
           Oj.dump c   147.320M memsize (     0.000  retained)
                         2.960M objects (     0.000  retained)
                        37.000  strings (     0.000  retained)
       Oj.dump c, aj   147.320M memsize (     0.000  retained)
                         2.960M objects (     0.000  retained)
                        37.000  strings (     0.000  retained)

Comparison:
           Oj.dump o:  147320000 allocated
           Oj.dump c:  147320000 allocated - same
       Oj.dump c, aj:  147320000 allocated - same
            to_json::  507722560 allocated - 3.45x more
---------------------------------------------

                     user     system      total        real
to_json:         3.970000   0.060000   4.030000 (  4.173902)
Oj.dump o      benchmark2.rb:32:in `dump': Too deeply nested. (NoMemoryError)
	from benchmark2.rb:32:in `block (3 levels) in <main>'
	from benchmark2.rb:32:in `times'
	from benchmark2.rb:32:in `block (2 levels) in <main>'
	from .rbenv/versions/2.4.0/lib/ruby/2.4.0/benchmark.rb:293:in `measure'
	from .rbenv/versions/2.4.0/lib/ruby/2.4.0/benchmark.rb:375:in `item'
	from benchmark2.rb:32:in `block in <main>'
	from .rbenv/versions/2.4.0/lib/ruby/2.4.0/benchmark.rb:173:in `benchmark'
	from benchmark2.rb:29:in `<main>'
FAILURE gemfile: gemfiles/5.0.2.gemfile  rvm: 2.4.0
rm -rf .bundle

Results:
FAILURE gemfile: gemfiles/4.1.16.gemfile rvm: 2.2.6
FAILURE gemfile: gemfiles/4.1.16.gemfile rvm: 2.3.3
FAILURE gemfile: gemfiles/4.1.16.gemfile rvm: 2.4.0
FAILURE gemfile: gemfiles/4.2.8.gemfile  rvm: 2.2.6
FAILURE gemfile: gemfiles/4.2.8.gemfile  rvm: 2.3.3
FAILURE gemfile: gemfiles/4.2.8.gemfile  rvm: 2.4.0
FAILURE gemfile: gemfiles/5.0.2.gemfile  rvm: 2.2.6
FAILURE gemfile: gemfiles/5.0.2.gemfile  rvm: 2.3.3
FAILURE gemfile: gemfiles/5.0.2.gemfile  rvm: 2.4.0

Failed:
BUNDLE_GEMFILE=gemfiles/4.1.16.gemfile RBENV_VERSION=2.2.6 bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark2.rb
BUNDLE_GEMFILE=gemfiles/4.1.16.gemfile RBENV_VERSION=2.3.3 bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark2.rb
BUNDLE_GEMFILE=gemfiles/4.1.16.gemfile RBENV_VERSION=2.4.0 bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark2.rb
BUNDLE_GEMFILE=gemfiles/4.2.8.gemfile RBENV_VERSION=2.2.6 bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark2.rb
BUNDLE_GEMFILE=gemfiles/4.2.8.gemfile RBENV_VERSION=2.3.3 bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark2.rb
BUNDLE_GEMFILE=gemfiles/4.2.8.gemfile RBENV_VERSION=2.4.0 bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark2.rb
BUNDLE_GEMFILE=gemfiles/5.0.2.gemfile RBENV_VERSION=2.2.6 bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark2.rb
BUNDLE_GEMFILE=gemfiles/5.0.2.gemfile RBENV_VERSION=2.3.3 bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark2.rb
BUNDLE_GEMFILE=gemfiles/5.0.2.gemfile RBENV_VERSION=2.4.0 bundle exec ruby compatibility_test.rb && bundle exec ruby benchmark2.rb
